<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="å‰è¨€ä»Šå¤©é¢è¯•æ»´æ»´çš„æ—¶å€™èŠåˆ°äº†è‡ªå·±ä»¥å‰é‡åˆ°çš„ä¸€ä¸ªå‘ï¼Œå…¶ä¸­æ¶‰åŠäº†ä¸€äº›å“åº”è€…é“¾æ¡çš„äº‹ã€‚æœ¬èº«è¿™ä¸ªbugå°±å¾ˆæœ‰ä»£è¡¨æ€§(ä»£è¡¨äº†è‡ªå·±å¯¹è¿™å—éå¸¸çš„ä¸ç†Ÿæ‚‰ğŸ˜ƒ)ã€‚æ— ç‹¬æœ‰å¶ï¼Œè‡ªå·±çš„å¥½åŸºå‹å‰å‡ å¤©è…¾è®¯ç”µé¢ä¸€é¢æ—¶ä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ã€‚å›æ¥å¥½å¥½çœ‹äº†å¤§ç¥çš„åšå®¢ã€‚å°±é¡ºæ‰‹å†™ä¸ªå­¦ä¹ ç¬”è®°è‡ªæˆ‘æ€»ç»“ä¸‹å§ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="èŠèŠå“åº”è€…é“¾">
<meta property="og:url" content="http://yoursite.com/2016/08/20/èŠèŠå“åº”è€…é“¾/index.html">
<meta property="og:site_name" content="ğŸ°BiuBiuBiu~">
<meta property="og:description" content="å‰è¨€ä»Šå¤©é¢è¯•æ»´æ»´çš„æ—¶å€™èŠåˆ°äº†è‡ªå·±ä»¥å‰é‡åˆ°çš„ä¸€ä¸ªå‘ï¼Œå…¶ä¸­æ¶‰åŠäº†ä¸€äº›å“åº”è€…é“¾æ¡çš„äº‹ã€‚æœ¬èº«è¿™ä¸ªbugå°±å¾ˆæœ‰ä»£è¡¨æ€§(ä»£è¡¨äº†è‡ªå·±å¯¹è¿™å—éå¸¸çš„ä¸ç†Ÿæ‚‰ğŸ˜ƒ)ã€‚æ— ç‹¬æœ‰å¶ï¼Œè‡ªå·±çš„å¥½åŸºå‹å‰å‡ å¤©è…¾è®¯ç”µé¢ä¸€é¢æ—¶ä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ã€‚å›æ¥å¥½å¥½çœ‹äº†å¤§ç¥çš„åšå®¢ã€‚å°±é¡ºæ‰‹å†™ä¸ªå­¦ä¹ ç¬”è®°è‡ªæˆ‘æ€»ç»“ä¸‹å§ã€‚">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1792274-621de0157a4b77a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1792274-001b9095d1e63fe3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1792274-6ab6cb6e961b46b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1792274-3f5f137ab5e2631f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2016-08-22T09:44:52.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="èŠèŠå“åº”è€…é“¾">
<meta name="twitter:description" content="å‰è¨€ä»Šå¤©é¢è¯•æ»´æ»´çš„æ—¶å€™èŠåˆ°äº†è‡ªå·±ä»¥å‰é‡åˆ°çš„ä¸€ä¸ªå‘ï¼Œå…¶ä¸­æ¶‰åŠäº†ä¸€äº›å“åº”è€…é“¾æ¡çš„äº‹ã€‚æœ¬èº«è¿™ä¸ªbugå°±å¾ˆæœ‰ä»£è¡¨æ€§(ä»£è¡¨äº†è‡ªå·±å¯¹è¿™å—éå¸¸çš„ä¸ç†Ÿæ‚‰ğŸ˜ƒ)ã€‚æ— ç‹¬æœ‰å¶ï¼Œè‡ªå·±çš„å¥½åŸºå‹å‰å‡ å¤©è…¾è®¯ç”µé¢ä¸€é¢æ—¶ä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ã€‚å›æ¥å¥½å¥½çœ‹äº†å¤§ç¥çš„åšå®¢ã€‚å°±é¡ºæ‰‹å†™ä¸ªå­¦ä¹ ç¬”è®°è‡ªæˆ‘æ€»ç»“ä¸‹å§ã€‚">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/1792274-621de0157a4b77a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/2016/08/20/èŠèŠå“åº”è€…é“¾/"/>

  <title> èŠèŠå“åº”è€…é“¾ | ğŸ°BiuBiuBiu~ </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">ğŸ°BiuBiuBiu~</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">è®°å½•è‡ªå·±å­¦ä¹ çš„ç‚¹ç‚¹æ»´æ»´</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            å…¬ç›Š404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                èŠèŠå“åº”è€…é“¾
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-08-20T17:49:48+08:00" content="2016-08-20">
              2016-08-20
            </time>
          </span>

          

          
            
          

          

          
          
             <span id="/2016/08/20/èŠèŠå“åº”è€…é“¾/" class="leancloud_visitors" data-flag-title="èŠèŠå“åº”è€…é“¾">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">visitors </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä»Šå¤©é¢è¯•æ»´æ»´çš„æ—¶å€™èŠåˆ°äº†<a href="http://www.jianshu.com/p/8f2f94ff0459" target="_blank" rel="external">è‡ªå·±ä»¥å‰é‡åˆ°çš„ä¸€ä¸ªå‘</a>ï¼Œå…¶ä¸­æ¶‰åŠäº†ä¸€äº›å“åº”è€…é“¾æ¡çš„äº‹ã€‚æœ¬èº«è¿™ä¸ªbugå°±å¾ˆæœ‰ä»£è¡¨æ€§(ä»£è¡¨äº†è‡ªå·±å¯¹è¿™å—éå¸¸çš„ä¸ç†Ÿæ‚‰ğŸ˜ƒ)ã€‚æ— ç‹¬æœ‰å¶ï¼Œè‡ªå·±çš„å¥½åŸºå‹å‰å‡ å¤©è…¾è®¯ç”µé¢ä¸€é¢æ—¶ä¹Ÿé‡åˆ°äº†<a href="http://kyxu.tech/2016/08/19/%E7%88%B6%E8%A7%86%E5%9B%BE%E5%A4%96%E9%83%A8%E5%AD%90%E8%A7%86%E5%9B%BE%E7%82%B9%E5%87%BB%E5%93%8D%E5%BA%94-hitTest/" target="_blank" rel="external">è¿™ä¸ªé—®é¢˜</a>ã€‚å›æ¥å¥½å¥½çœ‹äº†<a href="http://zhoon.github.io/ios/2015/04/12/ios-event.html" target="_blank" rel="external">å¤§ç¥çš„åšå®¢</a>ã€‚å°±é¡ºæ‰‹å†™ä¸ªå­¦ä¹ ç¬”è®°è‡ªæˆ‘æ€»ç»“ä¸‹å§ã€‚<br><a id="more"></a></p>
<h3 id="å…ˆèŠèŠå“åº”é“¾"><a href="#å…ˆèŠèŠå“åº”é“¾" class="headerlink" title="å…ˆèŠèŠå“åº”é“¾"></a>å…ˆèŠèŠå“åº”é“¾</h3><p><code>UIResponder</code>æ˜¯æ‰€æœ‰å¯ä»¥å“åº”äº‹ä»¶çš„ç±»çš„åŸºç±»(ä»åå­—åº”è¯¥å°±å¯ä»¥çœ‹å‡ºæ¥äº†)ï¼Œå…¶ä¸­åŒ…æ‹¬æœ€å¸¸è§çš„UIViewå’Œ<code>UIViewController</code>ç”šè‡³æ˜¯<code>UIApplication</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„<code>UIView</code>å’Œ<code>UIViewController</code>éƒ½æ˜¯ä½œä¸ºå“åº”äº‹ä»¶çš„è½½ä½“ã€‚</p>
<p>AppleğŸçˆ¸çˆ¸æ˜¯è¿™ä¹ˆè¯´çš„ï¼š</p>
<blockquote>
<p>The UIResponder class defines an interface for objects that respond to and handle events. It is the superclass of UIApplication, UIView and its subclasses (which include UIWindow). Instances of these classes are sometimes referred to as responder objects or, simply, responders.</p>
</blockquote>
<p>å…ˆçœ‹çœ‹è¿™ä¸ª<code>UIResponder</code>çš„å¤´æ–‡ä»¶ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKitDefines.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIEvent.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@class</span> <span class="title">UIPress</span>;</span></div><div class="line"><span class="class"><span class="keyword">@class</span> <span class="title">UIPressesEvent</span>;</span></div><div class="line"></div><div class="line"><span class="built_in">NS_CLASS_AVAILABLE_IOS</span>(<span class="number">2</span>_0) <span class="class"><span class="keyword">@interface</span> <span class="title">UIResponder</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">UIResponder</span>*)nextResponder;</div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)canBecomeFirstResponder;    <span class="comment">// default is NO</span></div><div class="line">- (<span class="built_in">BOOL</span>)becomeFirstResponder;</div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)canResignFirstResponder;    <span class="comment">// default is YES</span></div><div class="line">- (<span class="built_in">BOOL</span>)resignFirstResponder;</div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)isFirstResponder;</div><div class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="keyword">nullable</span> <span class="built_in">UIEvent</span> *)event;</div><div class="line">- (<span class="keyword">void</span>)touchesMoved:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="keyword">nullable</span> <span class="built_in">UIEvent</span> *)event;</div><div class="line">- (<span class="keyword">void</span>)touchesEnded:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="keyword">nullable</span> <span class="built_in">UIEvent</span> *)event;</div><div class="line">- (<span class="keyword">void</span>)touchesCancelled:(<span class="keyword">nullable</span> <span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="keyword">nullable</span> <span class="built_in">UIEvent</span> *)event;</div><div class="line">- (<span class="keyword">void</span>)touchesEstimatedPropertiesUpdated:(<span class="built_in">NSSet</span> * _Nonnull)touches <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_1);</div></pre></td></tr></table></figure>
<p>æ³¨ï¼šè¿™é‡Œæˆ‘åˆ é™¤äº†ä¸€äº›æ­¤æ–‡æ— å…³çš„å®šä¹‰</p>
<p>é‚£ä¹ˆ<code>UIResponder</code>å’Œæˆ‘ä»¬è®²çš„ç›¸åº”è€…é“¾æ¡åˆ°åº•æ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿå…¶å®åœ¨<code>iOS</code>ç³»ç»Ÿä¸­ï¼Œæ‰€è°“å“åº”è€…é“¾æ¡å°±æ˜¯ç”±è¿™äº›<code>UIResponder</code>é“¾æ¥èµ·æ¥çš„ã€‚ä½ å¯ä»¥æƒ³è±¡æˆé“¾è¡¨ï¼Œé“¾æ¥ä»–ä»¬çš„å°±æ˜¯ä¸Šé¢å®šä¹‰çš„å±æ€§<code>nextResponder</code>é“¾æ¥èµ·æ¥çš„ã€‚<br><img src="http://upload-images.jianshu.io/upload_images/1792274-621de0157a4b77a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å“åº”è€…é“¾æ¡"></p>
<h3 id="Hit-Testing-View"><a href="#Hit-Testing-View" class="headerlink" title="Hit-Testing View"></a><code>Hit-Testing View</code></h3><p>ç®€å•äº†è§£å“åº”è€…é“¾æ¡æ˜¯ä»€ä¹ˆåï¼Œå°±è¦ä»Šå¤©çš„ä¸»è§’ç™»åœºäº†ï¼š<code>Hit-Testing View</code>ã€‚</p>
<p>ä¸ŠèŠ‚æˆ‘ä»¬è®²åˆ°äº†å“åº”è€…é“¾æ¡ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è¯´æ¸…æ¥šå®ƒçš„å·¥ä½œæµç¨‹ã€‚æ¯”å¦‚ä¸Šå›¾ä¸­çš„<code>intial view</code>æ˜¯æ€ä¹ˆå¯»æ‰¾åˆ°çš„ï¼Ÿç³»ç»Ÿæ­£æ˜¯é€šè¿‡ä¸€ä¸ªå«åš<code>Hit-Test</code>è¿‡ç¨‹æ‰¾åˆ°è¿™ä¸ª<code>initial obje</code>çš„ã€‚</p>
<p><code>Hit-Test</code>çš„ç›®çš„å°±æ˜¯å¯»æ‰¾ç›®å‰æ‰‹æŒ‡ç‚¹å‡»åˆ°çš„é‚£ä¸ªæœ€å‰çš„<code>view</code>ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸º<code>responder</code>ã€‚<br>è¿™ä¸ªè¿‡ç¨‹å¯¹åº”çš„æ–¹æ³•åœ¨<code>UIView</code>é‡Œï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="keyword">nullable</span> <span class="built_in">UIEvent</span> *)event;   <span class="comment">// recursively calls -pointInside:withEvent:. point is in the receiver's coordinate system</span></div><div class="line">- (<span class="built_in">BOOL</span>)pointInside:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="keyword">nullable</span> <span class="built_in">UIEvent</span> *)event;   <span class="comment">// default returns YES if point is in bounds</span></div></pre></td></tr></table></figure>
<p>å½“ç”¨æˆ·ç‚¹å‡»äº†æ‰‹æœºå±å¹•æ—¶ï¼Œ<code>UIApplication</code>å°±ä¼šè°ƒç”¨<code>UIWindow</code>çš„<code>hitTest: withEvent:</code>æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æœ€ç»ˆè¿”å›ä¸€ä¸ª<code>UiView</code>ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æ‰¾åˆ°çš„é‚£ä¸ªæœ€å‰çš„<code>view</code>ã€‚é‚£è¿™ä¸ªæ–¹æ³•å…·ä½“æµç¨‹æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬æ‹¿ä¸‹å›¾è¯´æ˜ä¸‹ï¼š<br><img src="http://upload-images.jianshu.io/upload_images/1792274-001b9095d1e63fe3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å±‚æ¬¡ç»“æ„"></p>
<p><strong>UIWindowæœ‰ä¸€ä¸ªMianVIewï¼ŒMainViewé‡Œé¢æœ‰ä¸‰ä¸ªsubViewï¼šview Aã€view Bã€view Cï¼Œä»–ä»¬å„è‡ªæœ‰ä¸¤ä¸ªsubViewï¼Œä»–ä»¬å±‚çº§å…³ç³»æ˜¯ï¼šview Aåœ¨æœ€ä¸‹é¢ï¼Œview Bä¸­é—´ï¼Œview Cæœ€ä¸Š(ä¹Ÿå°±æ˜¯addSubviewçš„é¡ºåºï¼Œè¶Šæ™šaddè¿›å»è¶Šåœ¨ä¸Šé¢)ã€‚</strong></p>
<p><strong>ç°åœ¨å‡è®¾æ‰‹æŒ‡ç‚¹å‡»åœ¨äº†ç»¿è‰²çš„<code>View B</code>ä¸Šï¼š</strong><br>æ­¤æ—¶ï¼Œ<code>UIApplication</code>ä¼šè°ƒç”¨<code>UIWindow</code>çš„<code>hitTest:WithEvent:</code>æ–¹æ³•ï¼Œæ¥ç€<code>UIWindow</code>è°ƒç”¨ä¸Šé¢çš„ç¬¬äºŒä¸ªæ–¹æ³•ï¼š<code>pointInside:withEvent:</code>ã€‚ç°åœ¨æ‰‹æŒ‡ç‚¹å‡»çš„ä½ç½®æ˜¾ç„¶åœ¨<code>MainView</code>çš„<code>bounds</code>å†…ï¼Œäºæ˜¯è¿™ä¸ªæ–¹æ³•è¿”å›yesã€‚ç´§æ¥ç€ï¼Œ<code>MainView</code>å¼€å§‹éå†<code>subviews</code>ã€‚æ­¤å¤„éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šä»indexå€¼è¾ƒå¤§çš„ä½ç½®å¼€å§‹éå†ï¼Œæ¯”å¦‚æ­¤å¤„å°±ä¼šå…ˆæ‰¾åˆ°<code>VIew C</code>ä¸Šã€‚å› ä¸ºå®ƒæ˜¯æœ€åä¸€ä¸ªè¢«åŠ å…¥<code>subviews</code>æ•°ç»„é‡Œçš„ã€‚åœ¨è°ƒç”¨äº†<code>pointInside:withEvent:</code>æ–¹æ³•åï¼Œè¿”å›äº†NOã€‚äºæ˜¯ç»§ç»­åœ¨<code>MainView</code>çš„<strong>subview.index - 1</strong>çš„ä½ç½®ç»§ç»­è°ƒç”¨<code>pointInside:withEvent:</code>æ–¹æ³•ã€‚å¦‚æ­¤å¾ªç¯ï¼Œæœ€ç»ˆæ‰¾åˆ°æ‰‹æŒ‡æ­¤æ—¶è§¦æ‘¸çš„ä½ç½®:<code>View B.1</code>ã€‚<br><img src="http://upload-images.jianshu.io/upload_images/1792274-6ab6cb6e961b46b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è§¦æ‘¸å‘ç”Ÿæ—¶"></p>
<p>å®Œæ•´æµç¨‹ï¼š<br><img src="http://upload-images.jianshu.io/upload_images/1792274-3f5f137ab5e2631f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å®Œæ•´æµç¨‹"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šåˆ¤æ–­å½“å‰è¿™ä¸ª<code>view</code>æ˜¯ä¸æ˜¯<code>hitView</code>æ—¶ï¼Œéœ€è¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">view.userInteractionEnable == <span class="literal">YES</span></div><div class="line">view.hidden == <span class="literal">NO</span></div><div class="line">view.alpha &gt; <span class="number">0.01</span>f</div><div class="line">[view pointInside:point withEvent:event] == <span class="literal">YES</span></div></pre></td></tr></table></figure>
<p>ä»£ç å®ç°èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ğŸ˜„ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.hidden || <span class="keyword">self</span>.alpha &lt;= <span class="number">0.01</span>f || [<span class="keyword">self</span> pointInside:point withEvent:event] || !<span class="keyword">self</span>.userInteractionEnabled) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="built_in">UIView</span> *subview <span class="keyword">in</span> [<span class="keyword">self</span>.subviews reverseObjectEnumerator]) &#123;<span class="comment">//æ³¨æ„å€’å™</span></div><div class="line">     </div><div class="line">        <span class="built_in">CGPoint</span> newPoint = [subview convertPoint:point fromView:<span class="keyword">self</span>];</div><div class="line">        <span class="built_in">UIView</span> *hitView = [subview hitTest:newPoint withEvent:event];</div><div class="line">	        </div><div class="line">        <span class="keyword">if</span> (hitView) &#123;</div><div class="line">            <span class="keyword">return</span> hitView;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Hit-Testing-Viewåº”ç”¨"><a href="#Hit-Testing-Viewåº”ç”¨" class="headerlink" title="Hit-Testing Viewåº”ç”¨"></a><code>Hit-Testing View</code>åº”ç”¨</h3><h4 id="æœ€å¸¸ç”¨çš„ï¼šæ‰©å¤§æŒ‰é’®çƒ­åŒº"><a href="#æœ€å¸¸ç”¨çš„ï¼šæ‰©å¤§æŒ‰é’®çƒ­åŒº" class="headerlink" title="æœ€å¸¸ç”¨çš„ï¼šæ‰©å¤§æŒ‰é’®çƒ­åŒº"></a>æœ€å¸¸ç”¨çš„ï¼šæ‰©å¤§æŒ‰é’®çƒ­åŒº</h4><p>é¡¹ç›®ä¸­ç»å¸¸æœ‰æ‰©å¤§æŸä¸ªæŒ‰é’®çƒ­åŒºçš„éœ€æ±‚ï¼Œç›¸ä¿¡å®é™…åšè¿‡é¡¹ç›®çš„ç«¥é‹éƒ½æœ‰è¿‡è¿™æ ·çš„ç»å†ã€‚ä»¥å‰å°å¼Ÿçš„åšæ³•æ˜¯æŠŠæŒ‰é’®å®½é«˜è°ƒå¤§ä¸€ç‚¹ï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿä¼šå¯¼è‡´æŒ‰é’®å›¾ç‰‡ä½ç§»ï¼Œè¿˜è¦æ”¹æŒ‰é’®çš„<code>UIEdgeInsets</code>ç­‰å±æ€§ï¼Œå¾ˆæ˜¯è›‹ç–¼ã€‚æœ‰äº†<code>Hit-Testing View</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿™æ ·å†™ï¼šğŸ˜„</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</div><div class="line">    <span class="built_in">CGRect</span> originRect = <span class="keyword">self</span>.bounds;</div><div class="line">    originRect.origin = <span class="built_in">CGPointMake</span>(<span class="number">-15.0</span>f, <span class="number">-10.0</span>f);</div><div class="line">    originRect.size = <span class="built_in">CGSizeMake</span>(originRect.size.width + <span class="number">30.0</span>f, originRect.size.height + <span class="number">10.0</span>f + <span class="number">10.0</span>f);</div><div class="line">    </div><div class="line">    <span class="built_in">CGPoint</span> touchPoint = [<span class="keyword">self</span> convertPoint:point toView:<span class="keyword">self</span>];</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">CGRectContainsPoint</span>(originRect, touchPoint)) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> hitTest:point withEvent:event];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="äº‹ä»¶çš„ä¼ é€’"><a href="#äº‹ä»¶çš„ä¼ é€’" class="headerlink" title="äº‹ä»¶çš„ä¼ é€’"></a>äº‹ä»¶çš„ä¼ é€’</h3><p>æœ‰äº†å“åº”è€…é“¾æ¡ï¼Œäº‹ä»¶çš„ä¼ é€’ä¹Ÿå°±æ°´åˆ°æ¸ æˆäº†ã€‚åœ¨<code>UIApplication</code>è°ƒç”¨äº†<code>UIWIndow</code>çš„<code>hitTest:withEevent:</code>æ–¹æ³•å¹¶åæ‚”äº†ä¸€ä¸ª<code>hitView</code>åï¼Œå°±ä¼šé€šè¿‡<code>sendEvent:</code>è¿™ä¸ªæ–¹æ³•å°†äº‹ä»¶ä¼ é€’ç»™å½“å‰çš„<code>hitView</code>ã€‚å¦‚æœå½“å‰çš„<code>hitView</code>å¤„ç†ä¸äº†è¯¥äº‹ä»¶ï¼Œå°±ä¼šå°†äº‹ä»¶äº¤ç”±è‡ªå·±çš„<code>nextResponder</code>å¤„ç†ï¼Œå¦‚æ­¤é€’å½’ã€‚è‹¥æœ€åäº¤ç”±<code>UIApplication</code>ä»ç„¶å¤„ç†ä¸äº†è¯¥äº‹ä»¶ï¼Œç³»ç»Ÿå°±ä¼šæŠ›å¼ƒè¯¥äº‹ä»¶ã€‚</p>
<p>æ‘˜æŠ„ä¸€æ®µå¤§ç¥çš„åšå®¢:</p>
<blockquote>
<p>å¦‚æœ<code>view</code>é‡å†™äº†<code>touch</code>æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šçœ‹åˆ°çš„æ•ˆæœæ˜¯ï¼Œè¿™ä¸ª<code>view</code>å“åº”äº†äº‹ä»¶ä¹‹åï¼Œå®ƒ<code>nextResponder</code>ä¸ä¼šæ”¶åˆ°è¿™ä¸ªäº‹ä»¶ï¼Œå³ä½¿é‡å†™äº†<code>nextResponder</code>çš„<code>touch</code>æ–¹æ³•ã€‚è¿™ä¸ªæ—¶å€™å¦‚æœæƒ³äº‹ä»¶ç»§ç»­ä¼ é€’ä¸‹å»ï¼Œå¯ä»¥è°ƒç”¨<code>[super touchesBegan:touches withEvent:event]ï¼Œ</code>ä¸å»ºè®®ç›´æ¥è°ƒç”¨<code>[self.nextRespondertouchesBegan:touches withEvent:event]</code>ã€‚</p>
</blockquote>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>è¯·æ¯å’–å•¡å–ï¼Ÿ</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>èµ</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="http://i1.buimg.com/572363/b21593e5f65ea204.jpg" alt="Zheng Li WeChat Pay"/>
          <p>å¾®ä¿¡æ‰“èµ</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="http://i1.buimg.com/572363/7caac38df4844f66.jpg" alt="Zheng Li Alipay"/>
          <p>æ”¯ä»˜å®æ‰“èµ</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/08/20/æ·±å…¥ç†è§£objcä¸­çš„å¯¹è±¡ä¸ç±»/" rel="prev" title="æ·±å…¥ç†è§£objcä¸­çš„å¯¹è±¡ä¸ç±»">
                æ·±å…¥ç†è§£objcä¸­çš„å¯¹è±¡ä¸ç±» <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://tva3.sinaimg.cn/crop.0.0.511.511.180/006pqpL6jw8f4z97xky5nj30e70e8aai.jpg"
               alt="Zheng Li" />
          <p class="site-author-name" itemprop="name">Zheng Li</p>
          <p class="site-description motion-element" itemprop="description">iOSå¼€å‘èœé¸¡ï¼ŒåŠªåŠ›æé«˜è‡ªæˆ‘ä¸­ã€‚</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">5</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#å‰è¨€"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å…ˆèŠèŠå“åº”é“¾"><span class="nav-number">2.</span> <span class="nav-text">å…ˆèŠèŠå“åº”é“¾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hit-Testing-View"><span class="nav-number">3.</span> <span class="nav-text">Hit-Testing View</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hit-Testing-Viewåº”ç”¨"><span class="nav-number">4.</span> <span class="nav-text">Hit-Testing Viewåº”ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æœ€å¸¸ç”¨çš„ï¼šæ‰©å¤§æŒ‰é’®çƒ­åŒº"><span class="nav-number">4.1.</span> <span class="nav-text">æœ€å¸¸ç”¨çš„ï¼šæ‰©å¤§æŒ‰é’®çƒ­åŒº</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#äº‹ä»¶çš„ä¼ é€’"><span class="nav-number">5.</span> <span class="nav-text">äº‹ä»¶çš„ä¼ é€’</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zheng Li</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("28Bi52ufQCnrlpfv4vbx8JEG-gzGzoHsz", "1cAbB9JCSijqEURfv3Pa9uYd");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
